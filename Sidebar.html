<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: 'Roboto', sans-serif; padding: 10px; }
      label { font-weight: bold; display: block; margin-top: 10px; }
      input, button { width: 100%; padding: 8px; margin-top: 5px; }
      button { background-color: #4285f4; color: white; border: none; cursor: pointer; }
      button:hover { background-color: #3367d6; }
    </style>
  </head>
  <body>
    <h3>ğŸ“¤ ×™×™×¦×•× ××™×™×œ×™× ×œ-Drive</h3>
    <label for="query">×©××™×œ×ª×ª Gmail:</label>
    <input type="text" id="query" placeholder="×œ××©×œ: label:×œ×§×•×—×•×ª">

    <label for="folder">×§×™×©×•×¨ ×œ×ª×™×§×™×™×ª Drive:</label>
    <input type="text" id="folder" placeholder="https://drive.google.com/drive/folders/...">

    <button onclick="startExport()">ğŸš€ ×”×ª×—×œ×ª ×™×™×¦×•×</button>

    <div id="result" style="margin-top: 15px; color: green;"></div>

    <script>
      function startExport() {
        const query = document.getElementById("query").value;
        const folder = document.getElementById("folder").value;
        if (!query || !folder) {
          document.getElementById("result").innerText = "â— ×™×© ×œ××œ× ××ª ×›×œ ×”×©×“×•×ª.";
          return;
        }
        google.script.run.withSuccessHandler(msg => {
          document.getElementById("result").innerText = msg;
        }).withFailureHandler(err => {
          document.getElementById("result").innerText = "âŒ ×©×’×™××”: " + err.message;
        }).exportGmailToDriveIndex(query, folder);
      }
    </script>
  </body>
</html>
